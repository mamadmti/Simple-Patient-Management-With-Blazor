function initializeAutoLogout(){function n(){modalShown||localStorage.setItem("untilLogout",autoLogoutTimeout.toString())}autoLogoutTimeout=autoLogoutType=="UserBased"?userBaseAutoLogoutTimeout:appBaseAutoLogoutTimeout;localStorage.setItem("untilLogout",autoLogoutTimeout.toString());document.onmousemove=n;document.onkeypress=n;document.onvisibilitychange=()=>{document.hidden||n()};untilLogoutInterval=setInterval(()=>{if(!autoLogoutEnabled||autoLogoutType=="UserBased"&&!userBaseAutoLogoutEnabled){clearInterval(untilLogoutInterval);return}var n=parseInt(localStorage.getItem("untilLogout")||"0");n-=1e3;localStorage.setItem("untilLogout",n.toString());n<1e3?modalShown||ShowLogoutMessage():(modalShown&&HideLogoutMessage(),localStorage.setItem("untilLogout",n.toString()))},1e3)}function resetLogoutTimer(){clearInterval(logoutTimer);expireTime=new Date(`2020/01/01 ${expireTimeSpan}`).getTime();logoutTimer=setInterval(()=>{var n=new Date(expireTime);$("#logout-message-modal .timer").text(`${n.getMinutes()}:${n.getSeconds()}`);expireTime==new Date("2020/01/01 00:00:00").getTime()&&(clearInterval(logoutTimer),location.href="/Account/logout?AutoLogout=true");expireTime-=1e3},1e3)}function ShowLogoutMessage(){$(".CloseLogoutMessageButton").click(()=>{HideLogoutMessage(),localStorage.setItem("untilLogout",autoLogoutTimeout.toString())});$("#logout-message-modal").on("hide.bs.modal",function(){modalShown=!1;clearInterval(logoutTimer);localStorage.setItem("untilLogout",autoLogoutTimeout.toString())});$("#logout-message-modal").modal("show");modalShown=!0;resetLogoutTimer()}function HideLogoutMessage(){$("#logout-message-modal").modal("hide")}function initializeSignalRLogout(){var n=(new signalR.HubConnectionBuilder).withUrl("/users-hub").build();n.on("Logout",function(){location.href=location.href});n.on("StartAutoLogout",function(n,t,i){autoLogoutEnabled=n;autoLogoutType=t;appBaseAutoLogoutTimeout=i;initializeAutoLogout()});n.start().then(()=>{n.invoke("RegisterConnection",BrowserId).then(function(){}).catch(function(n){return console.error(n.toString())})}).catch(n=>console.error(n.toString()))}var timer,untilLogoutInterval,modalShown=!1,logoutTimer,expireTime;const expireTimeSpan="00:00:30";expireTime=new Date(`2020/01/01 ${expireTimeSpan}`).getTime();$(function(){signedIn&&(autoLogoutEnabled&&initializeAutoLogout(),initializeSignalRLogout())});
