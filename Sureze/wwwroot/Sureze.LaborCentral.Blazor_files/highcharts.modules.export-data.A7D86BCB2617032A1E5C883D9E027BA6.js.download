"use strict";var $jscomp=$jscomp||{},$jscomp$lookupPolyfilledValue;$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(n,t,i){return n==Array.prototype||n==Object.prototype?n:(n[t]=i.value,n)};$jscomp.getGlobal=function(n){var t,i;for(n=["object"==typeof globalThis&&globalThis,n,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global],t=0;t<n.length;++t)if(i=n[t],i&&i.Math==Math)return i;throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";$jscomp.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x");$jscomp$lookupPolyfilledValue=function(n,t){var i=$jscomp.propertyToPolyfillSymbol[t];return null==i?n[t]:(i=n[i],void 0!==i?i:n[t])};$jscomp.polyfill=function(n,t,i,r){t&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(n,t,i,r):$jscomp.polyfillUnisolated(n,t,i,r))};$jscomp.polyfillUnisolated=function(n,t,i,r){for(i=$jscomp.global,n=n.split("."),r=0;r<n.length-1;r++){var u=n[r];u in i||(i[u]={});i=i[u]}n=n[n.length-1];r=i[n];t=t(r);t!=r&&null!=t&&$jscomp.defineProperty(i,n,{configurable:!0,writable:!0,value:t})};$jscomp.polyfillIsolated=function(n,t,i,r){var u=n.split("."),f,e;for(n=1===u.length,r=u[0],r=!n&&(r in $jscomp.polyfills)?$jscomp.polyfills:$jscomp.global,f=0;f<u.length-1;f++)e=u[f],e in r||(r[e]={}),r=r[e];u=u[u.length-1];i=$jscomp.IS_SYMBOL_NATIVE&&"es6"===i?r[u]:null;t=t(i);null!=t&&(n?$jscomp.defineProperty($jscomp.polyfills,u,{configurable:!0,writable:!0,value:t}):t!==i&&($jscomp.propertyToPolyfillSymbol[u]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(u):$jscomp.POLYFILL_PREFIX+u,u=$jscomp.propertyToPolyfillSymbol[u],$jscomp.defineProperty(r,u,{configurable:!0,writable:!0,value:t})))};$jscomp.polyfill("Array.prototype.includes",function(n){return n?n:function(n,t){var i=this,r,u;for(i instanceof String&&(i=String(i)),r=i.length,t=t||0,0>t&&(t=Math.max(t+r,0));t<r;t++)if(u=i[t],u===n||Object.is(u,n))return!0;return!1}},"es7","es3"),function(n){"object"==typeof module&&module.exports?(n["default"]=n,module.exports=n):"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(t){return n(t),n.Highcharts=t,n}):n("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(n){function t(n,t,i,r){n.hasOwnProperty(t)||(n[t]=r.apply(null,i),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:n[t]}})))}n=n?n._modules:{};t(n,"Extensions/ExportData/ExportDataDefaults.js",[],function(){"";return{exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table"}}});t(n,"Extensions/DownloadURL.js",[n["Core/Globals.js"]],function(n){const{isSafari:f}=n,t=n.win,i=t.document,r=t.URL||t.webkitURL||t,u=n.dataURLtoBlob=function(n){if((n=n.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/))&&3<n.length&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&t.Blob&&r.createObjectURL){const u=t.atob(n[3]);var i=new t.ArrayBuffer(u.length);i=new t.Uint8Array(i);for(let n=0;n<i.length;++n)i[n]=u.charCodeAt(n);return n=new t.Blob([i],{type:n[1]}),r.createObjectURL(n)}};return n=n.downloadURL=function(n,r){var o=t.navigator;const e=i.createElement("a");if("string"==typeof n||n instanceof String||!o.msSaveOrOpenBlob){if(n=`${n}`,o=/Edge\/\d+/.test(o.userAgent),(f&&"string"==typeof n&&0===n.indexOf("data:application/pdf")||o||2e6<n.length)&&(n=u(n)||"",!n))throw Error("Failed to convert to blob");if("undefined"!=typeof e.download)e.href=n,e.download=r,i.body.appendChild(e),e.click(),i.body.removeChild(e);else try{const i=t.open(n,"chart");if("undefined"==typeof i||null===i)throw Error("Failed to open window");}catch(s){t.location.href=n}}else o.msSaveOrOpenBlob(n,r)},{dataURLtoBlob:u,downloadURL:n}});t(n,"Extensions/ExportData/ExportData.js",[n["Core/Renderer/HTML/AST.js"],n["Extensions/ExportData/ExportDataDefaults.js"],n["Core/Globals.js"],n["Core/Defaults.js"],n["Extensions/DownloadURL.js"],n["Core/Series/SeriesRegistry.js"],n["Core/Utilities.js"]],function(n,t,i,r,u,f,e){function tt(){const n=this.getCSV(!0);d(b(n,"text/csv")||"data:text/csv,﻿"+encodeURIComponent(n),this.getFilename()+".csv")}function it(){const n='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1<\/x:Name><x:WorksheetOptions><x:DisplayGridlines/><\/x:WorksheetOptions><\/x:ExcelWorksheet><\/x:ExcelWorksheets><\/x:ExcelWorkbook><\/xml><![endif]--><style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}<\/style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8><\/head><body>'+this.getTable(!0)+"<\/body><\/html>";d(b(n,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+o.btoa(unescape(encodeURIComponent(n))),this.getFilename()+".xls")}function rt(n){let r="";const t=this.getDataRows(),i=this.options.exporting.csv,u=s(i.decimalPoint,","!==i.itemDelimiter&&n?1.1.toLocaleString()[1]:"."),f=s(i.itemDelimiter,","===u?";":","),e=i.lineDelimiter;return t.forEach((n,i)=>{let o,s=n.length;for(;s--;)o=n[s],"string"==typeof o&&(o='"'+o+'"'),"number"==typeof o&&"."!==u&&(o=o.toString().replace(".",u)),n[s]=o;n.length=t.length?t[0].length:0;r+=n.join(f);i<t.length-1&&(r+=e)}),r}function ut(n){var i,f;const y=this.hasParallelCoordinates,b=this.time,h=this.options.exporting&&this.options.exporting.csv||{},k=this.xAxis,t={},c=[],d=[],v=[];i=this.options.lang.exportData;const g=i.categoryHeader,it=i.categoryDatetimeHeader,nt=function(t,i,r){if(h.columnHeaderFormatter){const n=h.columnHeaderFormatter(t,i,r);if(!1!==n)return n}return t?t instanceof yt?n?{columnTitle:1<r?i:t.name,topLevelColumnTitle:t.name}:t.name+(1<r?" ("+i+")":""):t.options.title&&t.options.title.text||(t.dateTime?it:g):g},tt=function(n,t,i){const r={},u={};return t.forEach(function(t){var f=(n.keyToAxis&&n.keyToAxis[t]||t)+"Axis";f=wt(i)?n.chart[f][i]:n[f];r[t]=f&&f.categories||[];u[t]=f&&f.dateTime}),{categoryMap:r,dateTimeValueAxisMap:u}},rt=function(n,t){return n.data.filter(n=>"undefined"!=typeof n.y&&n.name).length&&t&&!t.categories&&!n.keyToAxis?n.pointArrayMap&&n.pointArrayMap.filter(n=>"x"===n).length?(n.pointArrayMap.unshift("x"),n.pointArrayMap):["x","y"]:n.pointArrayMap||["y"]},e=[];let r,o,u=0;this.series.forEach(function(i){const c=i.xAxis,f=i.options.keys||rt(i,c),it=f.length,a=!i.requireSorting&&{},w=k.indexOf(c);let g=tt(i,f),l,r;if(!1!==i.options.includeInDataExport&&!i.options.isInternal&&!1!==i.visible){for(pt(e,function(n){return n[0]===w})||e.push([w,u]),r=0;r<it;)o=nt(i,f[r],f.length),v.push(o.columnTitle||o),n&&d.push(o.topLevelColumnTitle||o),r++;l={chart:i.chart,autoIncrement:i.autoIncrement,options:i.options,pointArrayMap:i.pointArrayMap,index:i.index};i.options.data.forEach(function(n,e){const v={series:l};let o;for(y&&(g=tt(i,f,e)),i.pointClass.prototype.applyOptions.apply(v,[n]),o=v.x,p(t[o])&&t[o].seriesIndices.includes(l.index)&&(n=Object.keys(t).filter(n=>t[n].seriesIndices.includes(l.index)&&o).filter(n=>0===n.indexOf(String(o))),o=o.toString()+","+n.length),n=i.data[e]&&i.data[e].name,r=0,(!c||"name"===i.exportKey||!y&&c&&c.hasNames&&n)&&(o=n),a&&(a[o]&&(o+="|"+e),a[o]=!0),t[o]||(t[o]=[],t[o].xValues=[]),t[o].x=v.x,t[o].name=n,t[o].xValues[w]=v.x,p(t[o].seriesIndices)||(t[o].seriesIndices=[]),t[o].seriesIndices=[...t[o].seriesIndices,l.index];r<it;)e=f[r],n=v[e],t[o][u+r]=s(g.categoryMap[e][n],g.dateTimeValueAxisMap[e]?b.dateFormat(h.dateFormat,n):null,n),r++});u+=r}});for(f in t)Object.hasOwnProperty.call(t,f)&&c.push(t[f]);let l,a;for(i=n?[d,v]:[v],u=e.length;u--;)l=e[u][0],a=e[u][1],r=k[l],c.sort(function(n,t){return n.xValues[l]-t.xValues[l]}),f=nt(r),i[0].splice(a,0,f),n&&i[1]&&i[1].splice(a,0,f),c.forEach(function(n){let t=n.name;r&&!p(t)&&(r.dateTime?(n.x instanceof Date&&(n.x=n.x.getTime()),t=b.dateFormat(h.dateFormat,n.x)):t=r.categories?s(r.names[n.x],r.categories[n.x],n.x):n.x);n.splice(a,0,t)});return i=i.concat(c),w(this,"exportData",{dataRows:i}),i}function ft(n){const t=n=>{if(!n.tagName||"#text"===n.tagName)return n.textContent||"";const r=n.attributes;let i=`<${n.tagName}`;return r&&Object.keys(r).forEach(n=>{i+=` ${n}="${r[n]}"`}),i+=">",i+=n.textContent||"",(n.children||[]).forEach(n=>{i+=t(n)}),i+=`</${n.tagName}>`};return n=this.getTableAST(n),t(n)}function et(n){let r=0;var t=[];const i=this.options,e=n?1.1.toLocaleString()[1]:".",f=s(i.exporting.useMultiLevelHeaders,!0);n=this.getDataRows(f);const c=f?n.shift():null,o=n.shift(),u=function(n,t,i,r){let u=s(r,"");return t="highcharts-text"+(t?" "+t:""),"number"==typeof u?(u=u.toString(),","===e&&(u=u.replace(".",e)),t="highcharts-number"):r||(t="highcharts-empty"),i=nt({"class":t},i),{tagName:n,attributes:i,textContent:u}};!1!==i.exporting.tableCaption&&t.push({tagName:"caption",attributes:{"class":"highcharts-table-caption"},textContent:s(i.exporting.tableCaption,i.title.text?i.title.text:"Chart")});for(let t=0,i=n.length;t<i;++t)n[t].length>r&&(r=n[t].length);t.push(function(n,t,r){var e,s,h;const l=[];let o=0;r=r||t&&t.length;let c=0;if(e=f&&n&&t){n:if(e=n.length,t.length===e){for(;e--;)if(n[e]!==t[e]){e=!1;break n}e=!0}else e=!1;e=!e}if(e){for(e=[];o<r;++o)s=n[o],h=n[o+1],s===h?++c:c?(e.push(u("th","highcharts-table-topheading",{scope:"col",colspan:c+1},s)),c=0):(s===t[o]?i.exporting.useRowspanHeaders?(h=2,delete t[o]):(h=1,t[o]=""):h=1,s=u("th","highcharts-table-topheading",{scope:"col"},s),1<h&&s.attributes&&(s.attributes.valign="top",s.attributes.rowspan=h),e.push(s));l.push({tagName:"tr",children:e})}if(t){for(n=[],o=0,r=t.length;o<r;++o)"undefined"!=typeof t[o]&&n.push(u("th",null,{scope:"col"},t[o]));l.push({tagName:"tr",children:n})}return{tagName:"thead",children:l}}(c,o,Math.max(r,o.length)));const h=[];return n.forEach(function(n){const t=[];for(let i=0;i<r;i++)t.push(u(i?"td":"th",null,i?{}:{scope:"row"},n[i]));h.push({tagName:"tr",children:t})}),t.push({tagName:"tbody",children:h}),t={tree:{tagName:"table",id:`highcharts-data-table-${this.index}`,children:t}},w(this,"aftergetTableAST",t),t.tree}function ot(){this.toggleDataTable(!1)}function st(t){var r=(t=s(t,!this.isDataTableVisible))&&!this.dataTableDiv,i,u;r&&(this.dataTableDiv=at.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling));this.dataTableDiv&&(i=this.dataTableDiv.style,u=i.display,i.display=t?"block":"none",t&&(this.dataTableDiv.innerHTML=n.emptyHTML,new n([this.getTableAST()]).addToDOM(this.dataTableDiv),w(this,"afterViewData",{element:this.dataTableDiv,wasHidden:r||u!==i.display})));this.isDataTableVisible=t;r=this.exportDivElements;u=(i=this.options.exporting)&&i.buttons&&i.buttons.contextButton.menuItems;t=this.options.lang;i&&i.menuItemDefinitions&&t&&t.viewData&&t.hideData&&u&&r&&(r=r[u.indexOf("viewData")])&&n.setElementHTML(r,this.isDataTableVisible?t.hideData:t.viewData)}function ht(){this.toggleDataTable(!0)}function b(n,t){const i=o.navigator,r=-1<i.userAgent.indexOf("WebKit")&&0>i.userAgent.indexOf("Chrome"),u=o.URL||o.webkitURL||o;try{if(i.msSaveOrOpenBlob&&o.MSBlobBuilder){const t=new o.MSBlobBuilder;return t.append(n),t.getBlob("image/svg+xml")}if(!r)return u.createObjectURL(new o.Blob(["﻿"+n],{type:t}))}catch(f){}}function ct(){const n=this,t=n.dataTableDiv,i=(n,t)=>(i,r)=>{var u=(t?i:r).children[n].textContent;return i=(t?r:i).children[n].textContent,""===u||""===i||isNaN(u)||isNaN(i)?u.toString().localeCompare(i):u-i};if(t&&n.options.exporting&&n.options.exporting.allowTableSorting){const r=t.querySelector("thead tr");r&&r.childNodes.forEach(r=>{const u=r.closest("table");r.addEventListener("click",function(){const e=[...t.querySelectorAll("tr:not(thead tr)")],f=[...r.parentNode.children];e.sort(i(f.indexOf(r),n.ascendingOrderInTable=!n.ascendingOrderInTable)).forEach(n=>{u.appendChild(n)});f.forEach(n=>{["highcharts-sort-ascending","highcharts-sort-descending"].forEach(t=>{n.classList.contains(t)&&n.classList.remove(t)})});r.classList.add(n.ascendingOrderInTable?"highcharts-sort-ascending":"highcharts-sort-descending")})})}}function lt(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}const{doc:at,win:o}=i,{getOptions:vt,setOptions:k}=r,{downloadURL:d}=u,{series:yt,seriesTypes:{arearange:c,gantt:l,map:a,mapbubble:v,treemap:y}}=f,{addEvent:g,defined:p,extend:nt,find:pt,fireEvent:w,isNumber:wt,pick:s}=e,h=[];return{compose:function(n){e.pushUnique(h,n)&&(g(n,"afterViewData",ct),g(n,"render",lt),n=n.prototype,n.downloadCSV=tt,n.downloadXLS=it,n.getCSV=rt,n.getDataRows=ut,n.getTable=ft,n.getTableAST=et,n.hideData=ot,n.toggleDataTable=st,n.viewData=ht);e.pushUnique(h,k)&&((n=vt().exporting)&&(nt(n.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.toggleDataTable()}}}),n.buttons&&n.buttons.contextButton.menuItems&&n.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),k(t));c&&e.pushUnique(h,c)&&(c.prototype.keyToAxis={low:"y",high:"y"});l&&e.pushUnique(h,l)&&(l.prototype.keyToAxis={start:"x",end:"x"});a&&e.pushUnique(h,a)&&(a.prototype.exportKey="name");v&&e.pushUnique(h,v)&&(v.prototype.exportKey="name");y&&e.pushUnique(h,y)&&(y.prototype.exportKey="name")}}});t(n,"masters/modules/export-data.src.js",[n["Core/Globals.js"],n["Extensions/ExportData/ExportData.js"]],function(n,t){t.compose(n.Chart)})});
